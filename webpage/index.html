<html>
	<head>
		<title>Mobile Friendly Poetry</title>
		<meta name="viewport" content="width=device-width, initial-scale=1">

		<link rel="stylesheet" type="text/css" href="style.css">

		<!-- Normally bad practice to put scripts here, but they're loading asynchronously and we want them loading the dataset asap -->
		<script src="define-objects.js" type="text/javascript"></script>
		<script async src="synsets.js" type="text/javascript"></script>
		<script async src="hypernyms.js" type="text/javascript"></script>
		<script async src="reverse-mapper.js" type="text/javascript"></script>
	</head>

	<body>
		<div class="phone">
			<div class="screen"> <div class="screen-padding">
				<div class="contents">

					<br> <br> <br> <br> <br> <br> <br> <br>

					<span id="w0" class="word"> w0 </span> <br>
					<span id="d0"> d0 </span>

					<br> <br> <br> <br> <br> <br> <br> <br>
					<br> <br> <br> <br> <br> <br> <br> <br>

					<span class="word"> Is <br> </span>

					<br> <br> <br> <br> <br> <br> <br> <br>
					<br> <br> <br> <br> <br> <br> <br> <br>

					<span id="w1" class="word"> w1 </span> <br>
					<span id="d1"> d1 <br> </span>

					<br> <br> <br> <br> <br> <br> <br> <br>
					<br> <br> <br> <br> <br> <br> <br> <br>

					<span class="word"> Is <br> </span>

					<br> <br> <br> <br> <br> <br> <br> <br>
					<br> <br> <br> <br> <br> <br> <br> <br>

					<span id="w2" class="word"> w2 </span> <br>
					<span id="d2"> d2 <br> </span>

					<br> <br> <br> <br> <br> <br> <br> <br>
					<br> <br> <br> <br> <br> <br> <br> <br>

					<span class="word"> Is <br> </span>

					<br> <br> <br> <br> <br> <br> <br> <br>
					<br> <br> <br> <br> <br> <br> <br> <br>

					<span id="w3" class="word"> w3 </span> <br>
					<span id="d3"> d3 <br> </span>

					<br> <br> <br> <br> <br> <br> <br> <br>
					<br> <br> <br> <br> <br> <br> <br> <br>

					<span class="word"> Is <br> </span>

					<br> <br> <br> <br> <br> <br> <br> <br>
					<br> <br> <br> <br> <br> <br> <br> <br>

					<span id="w4" class="word"> w4 </span><br>
					<span id="d4"> d4 <br> </span>

					<br> <br> <br> <br> <br> <br> <br> <br>

				</div>
			</div></div>
		</div>

		<script type="text/javascript">
			/* These functions have example usage for the word dataset.  Note that
			there is no error handling yet, so it should be added before use in
			production. */

			// returns an integer id for a given word (or null if it doesn't exist)
			function getIdForWord(word) {
				return wordToIdsMap[word.trim().toLowerCase()];
			}

			// returns a list of words for a given id (or null if the id is invalid)
			function getWordsById(id) {
				return idToWordsMap[id];
			}

			// return a definition for a given id (or null if the id is invalid)
			function getDefinitionById(id) {
				return definitions[id];
			}

			// returns a list of hypernyms (word ids) for a given word (or null if the word doesn't exist)
			function getHypernymsForWord(word) {
				return getHypernymsById(getIdForWord(word));
			}

			// returns a list of hypernyms (word ids) for a given child id (or null if the id is invalid)
			function getHypernymsById(id) {
				return hypernyms[id];
			}

			// returns a list of hyponyms (word ids) for a given parent id (or null if id is invalid)
			function getHyponymsById(id) {
				return hyponyms[id];
			}

			// randomly samples for a parent of current synset and returns the ID;
			// returns -1 if no such parent exists
			function findParent(currID) {
				let currSynset = getHypernymsById(currID);
				if (!currSynset) return -1;
				let m = Math.round(Math.random() * currSynset.length);
				currID = currSynset[m];
			}

			// randomly samples for a child of current synset and returns the ID;
			// returns -1 if no such child exists
			function findChild(currID) {
				let currSynset = getHyponymsById(currID);
				if (!currSynset) return -1;
				let m = Math.round(Math.random() * currSynset.length);
				currID = currSynset[m];
			}

			// main function
			function createMetaphor(firstWord='passion', numWords=5, numSteps=1, probToParent=1.0) {
				//let firstWordID = getIdForWord(firstWord);
				//console.log('firstWordID: ' + firstWordID);
				let firstWordID = 12897;

				document.getElementById("w0").innerHTML = firstWordID;
				document.getElementById("w0").innerHTML = firstWord;
				document.getElementById("d0").innerHTML = getDefinitionById(firstWordID);

				let currID = firstWordID;
				// write outer loop to get numWords # of words
				for (i = 1; i < numWords; i++) {
					// write inner loop to get numSteps # of steps
					for (j = 0; j < numSteps; j++) {
						// select random k between 0 and 1
						let k = Math.random();
						// find child and update ID
						if (k > probToParent) {
							let newID = findChild(currID);
							if (newID < 0) newID = findParent(currID);
							currID = newID;
						} else { // find parent and update ID
							let newID = findParent(currID);
							if (newID < 0) newID = findChild(currID);
							currID = newID;
						}
						console.log('currID: ' + currID);
					}
				}

				// change inner HTML
				let words = getWordsById(currID);
				const m = Math.round(Math.random() * words.length);
				const currWord = words[m];
				document.getElementById("w" + i).innerHTML = currWord
				document.getElementById("d" + i).innerHTML = getDefinitionById(currID)
			}

			//createMetaphor();

		</script>
	</body>
</html>